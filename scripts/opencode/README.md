# OpenCode 汉化工具

**OpenCode 中文汉化版**是对 OpenCode 项目的本地化改造，通过模块化汉化配置和自动化脚本实现完整中文化。

## 核心功能

- 🤖 AI 辅助编程 - 解释代码、添加功能、重构修改
- 📋 Plan 模式 - 先规划后实施，支持图片参考和迭代讨论
- ↩️ 撤销/重做 - `/undo` 和 `/redo` 命令轻松回退
- 🔗 对话分享 - 生成链接与团队协作
- 🔌 多模型支持 - 兼容各类 LLM 提供商

## 使用方法

### 一键汉化+部署

```powershell
.\scripts\opencode\opencode.ps1
# 选择 [1] 一键汉化+部署
```

### 分步操作

| 步骤 | 菜单选项 | 说明 |
|------|----------|------|
| 拉取代码 | 高级菜单 → [1] | 从官方仓库获取最新源码 |
| 应用汉化 | 高级菜单 → [2] | 应用中文翻译到源码 |
| 编译程序 | 高级菜单 → [3] | 使用 Bun 编译项目 |
| 部署 | 高级菜单 → [9] | 替换全局 OpenCode 版本 |

### 版本更新

```powershell
.\scripts\opencode\opencode.ps1
# 选择 [5] 版本检测
# 如有新版本，按提示输入 y 确认更新
```

## 菜单说明

### 主菜单

| 选项 | 功能 | 适用场景 |
|------|------|----------|
| [1] | 一键汉化+部署 | 首次使用或需要完整更新 |
| [2] | 应用汉化 | 仅应用翻译，不编译 |
| [3] | 验证汉化 | 检查翻译覆盖率 |
| [4] | 调试工具 | 排查汉化问题 |
| [5] | 版本检测 | 检查并更新官方版本 |
| [6] | 备份版本 | 备份当前汉化版本 |
| [7] | 高级菜单 | 更多高级选项 |
| [R] | 恢复纯净 | 撤销汉化，恢复到出厂状态 |

### 高级菜单

| 选项 | 功能 |
|------|------|
| [1] | 拉取最新代码（支持自动检测代理） |
| [2] | 应用汉化补丁 |
| [3] | 编译程序 |
| [4] | 版本检测 |
| [5] | 备份源码和编译产物 |
| [6] | 从备份恢复 |
| [7] | 恢复原始文件 |
| [8] | 打开输出目录 |
| [9] | 替换全局版本 |
| [C] | 清理工具（缓存、临时文件） |
| [L] | 启动 OpenCode |
| [R] | 源码恢复（强制重置） |
| [S] | 恢复脚本 |

## 文件说明

| 文件 | 说明 |
|------|------|
| `opencode.ps1` | 主脚本（4700+ 行） |
| `init.ps1` | 自动初始化脚本 |

## 汉化范围

| 模块 | 覆盖内容 |
|------|----------|
| 命令面板 | 会话管理、模型选择、智能体切换 |
| 对话框 | 智能体选择器、会话列表、消息处理 |
| 侧边栏 | 上下文管理、MCP 状态显示 |
| 顶部栏 | 子智能体导航 |
| 权限系统 | 文件操作权限请求 |
| 通知提示 | 70+ 条操作提示信息 |

## 常见问题

| 问题 | 解决方法 |
|------|----------|
| 执行策略错误 | `Set-ExecutionPolicy -Scope Process -ExecutionPolicy Bypass` |
| 编译失败 | 运行 `bun upgrade` 或重新安装 Bun |
| 汉化未生效 | 运行 `[2] 应用汉化` 重新应用 |
| 网络超时 | 脚本会自动检测并使用本地代理 |
| 源码目录为空 | 运行 `.\\init.ps1` 自动克隆 |

## 版本历史

| 版本 | 日期 | 更新内容 |
|------|------|----------|
| 5.4 | 2026-01-10 | 新用户友好：自动初始化、备用下载、一键恢复纯净 |
| 5.3 | 2026-01-10 | 改进版本检测与自动更新 |
| 5.2 | 2026-01-09 | 修复汉化污染问题 |
| 5.1 | 2026-01-09 | 添加语言包版本适配检测 |
| 5.0 | 2026-01-08 | 优化文件标记速度和进度提示 |
